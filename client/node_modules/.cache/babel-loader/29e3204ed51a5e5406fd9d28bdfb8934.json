{"ast":null,"code":"var util = require('util');\n\nvar EventEmitter = require('events').EventEmitter;\n\nvar IOStream = require('./iostream');\n\nvar slice = Array.prototype.slice;\nexports.Encoder = Encoder;\nexports.Decoder = Decoder;\nutil.inherits(Encoder, EventEmitter);\n\nfunction Encoder() {\n  EventEmitter.call(this);\n}\n/**\n * Encode streams to placeholder objects.\n *\n * @api public\n */\n\n\nEncoder.prototype.encode = function (v) {\n  if (v instanceof IOStream) {\n    return this.encodeStream(v);\n  } else if (util.isArray(v)) {\n    return this.encodeArray(v);\n  } else if (v && 'object' == typeof v) {\n    return this.encodeObject(v);\n  }\n\n  return v;\n};\n\nEncoder.prototype.encodeStream = function (stream) {\n  this.emit('stream', stream); // represent a stream in an object.\n\n  var v = {\n    $stream: stream.id\n  };\n\n  if (stream.options) {\n    v.options = stream.options;\n  }\n\n  return v;\n};\n\nEncoder.prototype.encodeArray = function (arr) {\n  var v = [];\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    v.push(this.encode(arr[i]));\n  }\n\n  return v;\n};\n\nEncoder.prototype.encodeObject = function (obj) {\n  var v = {};\n\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k)) {\n      v[k] = this.encode(obj[k]);\n    }\n  }\n\n  return v;\n};\n\nutil.inherits(Decoder, EventEmitter);\n\nfunction Decoder() {\n  EventEmitter.call(this);\n}\n/**\n * Decode placeholder objects to streams.\n *\n * @api public\n */\n\n\nDecoder.prototype.decode = function (v) {\n  if (v && v.$stream) {\n    return this.decodeStream(v);\n  } else if (util.isArray(v)) {\n    return this.decodeArray(v);\n  } else if (v && 'object' == typeof v) {\n    return this.decodeObject(v);\n  }\n\n  return v;\n};\n\nDecoder.prototype.decodeStream = function (obj) {\n  var stream = new IOStream(obj.options);\n  stream.id = obj.$stream;\n  this.emit('stream', stream);\n  return stream;\n};\n\nDecoder.prototype.decodeArray = function (arr) {\n  var v = [];\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    v.push(this.decode(arr[i]));\n  }\n\n  return v;\n};\n\nDecoder.prototype.decodeObject = function (obj) {\n  var v = {};\n\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k)) {\n      v[k] = this.decode(obj[k]);\n    }\n  }\n\n  return v;\n};","map":{"version":3,"sources":["E:/video_project/client/node_modules/socket.io-stream/lib/parser.js"],"names":["util","require","EventEmitter","IOStream","slice","Array","prototype","exports","Encoder","Decoder","inherits","call","encode","v","encodeStream","isArray","encodeArray","encodeObject","stream","emit","$stream","id","options","arr","i","len","length","push","obj","k","hasOwnProperty","decode","decodeStream","decodeArray","decodeObject"],"mappings":"AAAA,IAAIA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAAlB;;AACA,IAAIC,YAAY,GAAGD,OAAO,CAAC,QAAD,CAAP,CAAkBC,YAArC;;AACA,IAAIC,QAAQ,GAAGF,OAAO,CAAC,YAAD,CAAtB;;AACA,IAAIG,KAAK,GAAGC,KAAK,CAACC,SAAN,CAAgBF,KAA5B;AAEAG,OAAO,CAACC,OAAR,GAAkBA,OAAlB;AACAD,OAAO,CAACE,OAAR,GAAkBA,OAAlB;AAEAT,IAAI,CAACU,QAAL,CAAcF,OAAd,EAAuBN,YAAvB;;AAEA,SAASM,OAAT,GAAmB;AACjBN,EAAAA,YAAY,CAACS,IAAb,CAAkB,IAAlB;AACD;AAED;AACA;AACA;AACA;AACA;;;AACAH,OAAO,CAACF,SAAR,CAAkBM,MAAlB,GAA2B,UAASC,CAAT,EAAY;AACrC,MAAIA,CAAC,YAAYV,QAAjB,EAA2B;AACzB,WAAO,KAAKW,YAAL,CAAkBD,CAAlB,CAAP;AACD,GAFD,MAEO,IAAIb,IAAI,CAACe,OAAL,CAAaF,CAAb,CAAJ,EAAqB;AAC1B,WAAO,KAAKG,WAAL,CAAiBH,CAAjB,CAAP;AACD,GAFM,MAEA,IAAIA,CAAC,IAAI,YAAY,OAAOA,CAA5B,EAA+B;AACpC,WAAO,KAAKI,YAAL,CAAkBJ,CAAlB,CAAP;AACD;;AACD,SAAOA,CAAP;AACD,CATD;;AAWAL,OAAO,CAACF,SAAR,CAAkBQ,YAAlB,GAAiC,UAASI,MAAT,EAAiB;AAChD,OAAKC,IAAL,CAAU,QAAV,EAAoBD,MAApB,EADgD,CAGhD;;AACA,MAAIL,CAAC,GAAG;AAAEO,IAAAA,OAAO,EAAEF,MAAM,CAACG;AAAlB,GAAR;;AACA,MAAIH,MAAM,CAACI,OAAX,EAAoB;AAClBT,IAAAA,CAAC,CAACS,OAAF,GAAYJ,MAAM,CAACI,OAAnB;AACD;;AACD,SAAOT,CAAP;AACD,CATD;;AAWAL,OAAO,CAACF,SAAR,CAAkBU,WAAlB,GAAgC,UAASO,GAAT,EAAc;AAC5C,MAAIV,CAAC,GAAG,EAAR;;AACA,OAAK,IAAIW,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGF,GAAG,CAACG,MAA1B,EAAkCF,CAAC,GAAGC,GAAtC,EAA2CD,CAAC,EAA5C,EAAgD;AAC9CX,IAAAA,CAAC,CAACc,IAAF,CAAO,KAAKf,MAAL,CAAYW,GAAG,CAACC,CAAD,CAAf,CAAP;AACD;;AACD,SAAOX,CAAP;AACD,CAND;;AAQAL,OAAO,CAACF,SAAR,CAAkBW,YAAlB,GAAiC,UAASW,GAAT,EAAc;AAC7C,MAAIf,CAAC,GAAG,EAAR;;AACA,OAAK,IAAIgB,CAAT,IAAcD,GAAd,EAAmB;AACjB,QAAIA,GAAG,CAACE,cAAJ,CAAmBD,CAAnB,CAAJ,EAA2B;AACzBhB,MAAAA,CAAC,CAACgB,CAAD,CAAD,GAAO,KAAKjB,MAAL,CAAYgB,GAAG,CAACC,CAAD,CAAf,CAAP;AACD;AACF;;AACD,SAAOhB,CAAP;AACD,CARD;;AAUAb,IAAI,CAACU,QAAL,CAAcD,OAAd,EAAuBP,YAAvB;;AAEA,SAASO,OAAT,GAAmB;AACjBP,EAAAA,YAAY,CAACS,IAAb,CAAkB,IAAlB;AACD;AAED;AACA;AACA;AACA;AACA;;;AACAF,OAAO,CAACH,SAAR,CAAkByB,MAAlB,GAA2B,UAASlB,CAAT,EAAY;AACrC,MAAIA,CAAC,IAAIA,CAAC,CAACO,OAAX,EAAoB;AAClB,WAAO,KAAKY,YAAL,CAAkBnB,CAAlB,CAAP;AACD,GAFD,MAEO,IAAIb,IAAI,CAACe,OAAL,CAAaF,CAAb,CAAJ,EAAqB;AAC1B,WAAO,KAAKoB,WAAL,CAAiBpB,CAAjB,CAAP;AACD,GAFM,MAEA,IAAIA,CAAC,IAAI,YAAY,OAAOA,CAA5B,EAA+B;AACpC,WAAO,KAAKqB,YAAL,CAAkBrB,CAAlB,CAAP;AACD;;AACD,SAAOA,CAAP;AACD,CATD;;AAWAJ,OAAO,CAACH,SAAR,CAAkB0B,YAAlB,GAAiC,UAASJ,GAAT,EAAc;AAC7C,MAAIV,MAAM,GAAG,IAAIf,QAAJ,CAAayB,GAAG,CAACN,OAAjB,CAAb;AACAJ,EAAAA,MAAM,CAACG,EAAP,GAAYO,GAAG,CAACR,OAAhB;AACA,OAAKD,IAAL,CAAU,QAAV,EAAoBD,MAApB;AACA,SAAOA,MAAP;AACD,CALD;;AAOAT,OAAO,CAACH,SAAR,CAAkB2B,WAAlB,GAAgC,UAASV,GAAT,EAAc;AAC5C,MAAIV,CAAC,GAAG,EAAR;;AACA,OAAK,IAAIW,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGF,GAAG,CAACG,MAA1B,EAAkCF,CAAC,GAAGC,GAAtC,EAA2CD,CAAC,EAA5C,EAAgD;AAC9CX,IAAAA,CAAC,CAACc,IAAF,CAAO,KAAKI,MAAL,CAAYR,GAAG,CAACC,CAAD,CAAf,CAAP;AACD;;AACD,SAAOX,CAAP;AACD,CAND;;AAQAJ,OAAO,CAACH,SAAR,CAAkB4B,YAAlB,GAAiC,UAASN,GAAT,EAAc;AAC7C,MAAIf,CAAC,GAAG,EAAR;;AACA,OAAK,IAAIgB,CAAT,IAAcD,GAAd,EAAmB;AACjB,QAAIA,GAAG,CAACE,cAAJ,CAAmBD,CAAnB,CAAJ,EAA2B;AACzBhB,MAAAA,CAAC,CAACgB,CAAD,CAAD,GAAO,KAAKE,MAAL,CAAYH,GAAG,CAACC,CAAD,CAAf,CAAP;AACD;AACF;;AACD,SAAOhB,CAAP;AACD,CARD","sourcesContent":["var util = require('util');\nvar EventEmitter = require('events').EventEmitter;\nvar IOStream = require('./iostream');\nvar slice = Array.prototype.slice;\n\nexports.Encoder = Encoder;\nexports.Decoder = Decoder;\n\nutil.inherits(Encoder, EventEmitter);\n\nfunction Encoder() {\n  EventEmitter.call(this);\n}\n\n/**\n * Encode streams to placeholder objects.\n *\n * @api public\n */\nEncoder.prototype.encode = function(v) {\n  if (v instanceof IOStream) {\n    return this.encodeStream(v);\n  } else if (util.isArray(v)) {\n    return this.encodeArray(v);\n  } else if (v && 'object' == typeof v) {\n    return this.encodeObject(v);\n  }\n  return v;\n}\n\nEncoder.prototype.encodeStream = function(stream) {\n  this.emit('stream', stream);\n\n  // represent a stream in an object.\n  var v = { $stream: stream.id };\n  if (stream.options) {\n    v.options = stream.options;\n  }\n  return v;\n}\n\nEncoder.prototype.encodeArray = function(arr) {\n  var v = [];\n  for (var i = 0, len = arr.length; i < len; i++) {\n    v.push(this.encode(arr[i]));\n  }\n  return v;\n}\n\nEncoder.prototype.encodeObject = function(obj) {\n  var v = {};\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k)) {\n      v[k] = this.encode(obj[k]);\n    }\n  }\n  return v;\n}\n\nutil.inherits(Decoder, EventEmitter);\n\nfunction Decoder() {\n  EventEmitter.call(this);\n}\n\n/**\n * Decode placeholder objects to streams.\n *\n * @api public\n */\nDecoder.prototype.decode = function(v) {\n  if (v && v.$stream) {\n    return this.decodeStream(v);\n  } else if (util.isArray(v)) {\n    return this.decodeArray(v);\n  } else if (v && 'object' == typeof v) {\n    return this.decodeObject(v);\n  }\n  return v;\n}\n\nDecoder.prototype.decodeStream = function(obj) {\n  var stream = new IOStream(obj.options);\n  stream.id = obj.$stream;\n  this.emit('stream', stream);\n  return stream;\n}\n\nDecoder.prototype.decodeArray = function(arr) {\n  var v = [];\n  for (var i = 0, len = arr.length; i < len; i++) {\n    v.push(this.decode(arr[i]));\n  }\n  return v;\n}\n\nDecoder.prototype.decodeObject = function(obj) {\n  var v = {};\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k)) {\n      v[k] = this.decode(obj[k]);\n    }\n  }\n  return v;\n}\n"]},"metadata":{},"sourceType":"script"}