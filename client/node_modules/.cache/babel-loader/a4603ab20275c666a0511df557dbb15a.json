{"ast":null,"code":"var _jsxFileName = \"E:\\\\video_project\\\\client\\\\src\\\\Components\\\\Videochatroom.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { io } from \"socket.io-client\";\nimport { withRouter } from \"react-router-dom\";\nimport Peer from \"peerjs\"; //import { validate as uuidValidate } from \"uuid\";\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Videochatroom = props => {\n  _s();\n\n  // let socketInstance = useRef(null);\n  const [socket, setSocket] = useState(null);\n  const [peers, addpeers] = useState({}); // const [mystream, setstream] = useState(null);\n\n  const [mypeerID, setmypeerID] = useState(\"\");\n  useEffect(() => {\n    const myPeer = new Peer(undefined, {\n      host: \"/\",\n      port: \"3008\"\n    }); //setmypeer(myPeer);\n\n    console.log(props.match.params.id);\n    console.log(\"mount it using useEffect!\");\n    const newsocket = io.connect(\"http://localhost:4000\", {\n      query: {\n        roomId: props.match.params.id\n      }\n    });\n    console.log(\"socket id \" + newsocket.id);\n    setSocket(newsocket);\n    myPeer.on(\"open\", id => {\n      console.log(\"user id send to join room \" + id);\n      setmypeerID(id);\n      newsocket.emit(\"join-room\", id);\n    });\n    const myVideo = document.getElementById(\"myvideo\");\n    myVideo.muted = true;\n    console.log(\"alright now \");\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(stream => {\n      // setstream(stream);\n      addVideoStream(myVideo, stream);\n      newsocket.on(\"user-connected\", userId => {\n        console.log(\"user id received of new user\" + userId);\n        setTimeout(connectToNewUser, 1000, userId, stream, myPeer); // connectToNewUser(userId, stream, myPeer);\n      });\n      newsocket.on(\"user-disconnected\", userId => {\n        console.log(\"userid disconnected \" + userId);\n        const disconnectedVideo = document.getElementById(userId);\n\n        if (userId) {\n          disconnectedVideo.remove();\n        }\n\n        if (peers[userId]) peers[userId].close();\n      });\n      newsocket.on(\"mute-unmute\", data => {\n        if (data.id != myPeer.id) {\n          const peervideo = document.getElementById(data.id);\n          if (data.mute) peervideo.muted = true;else peervideo.muted = false;\n        }\n      });\n      myPeer.on(\"call\", call => {\n        console.log(\"someone calling\");\n        call.answer(stream);\n        const video = document.createElement(\"video\");\n        console.log(\"call.peer \" + call.peer);\n        video.id = call.peer;\n        video.muted = true;\n        call.on(\"stream\", userVideoStream => {\n          addVideoStream(video, userVideoStream);\n        });\n        call.on(\"close\", () => {\n          console.log(\"call closing\");\n          myVideo.remove();\n        });\n      });\n    }); // return works like component will unmount\n\n    return () => {\n      newsocket.emit(\"user-disconnected\", myPeer.id);\n      newsocket.removeAllListeners();\n      const element = document.getElementById(myPeer.id);\n      const myMediaTracks = element === null || element === void 0 ? void 0 : element.stream.getTracks();\n      myMediaTracks === null || myMediaTracks === void 0 ? void 0 : myMediaTracks.forEach(track => {\n        track.stop();\n      });\n    };\n  }, []);\n\n  const connectToNewUser = async (userId, stream, myPeer) => {\n    console.log(\"connecting to newuser! \");\n    const call = await myPeer.call(userId, stream);\n    call.on(\"error\", error => {\n      console.log(error);\n    }); // adding peers flush updates\n\n    console.log(\"peers adding \");\n    addpeers(prevstate => ({ ...prevstate,\n      [userId]: call\n    }));\n    const video = document.createElement(\"video\");\n    video.id = userId;\n    video.muted = true;\n    console.log(\"cALL \" + call + \"peer \" + myPeer.id);\n    if (call === null || call === \"\" || call === undefined) console.log(\"null\");\n    await call.on(\"stream\", userVideoStream => {\n      console.log(\"streaming \");\n      addVideoStream(video, userVideoStream);\n    });\n    call.on(\"close\", () => {\n      console.log(\"call closing \");\n      video.remove();\n    });\n    console.log(\"close\");\n  };\n\n  const addVideoStream = (video, stream) => {\n    console.log(\"adding video stream with id \", video.id);\n    const videoGrid = document.getElementById(\"video-grid\");\n    video.srcObject = stream;\n    video.addEventListener(\"loadedmetadata\", () => {\n      video.play();\n    });\n    videoGrid.append(video);\n    console.log(\":appending\");\n  };\n\n  const muteunmute = () => {\n    const v = document.getElementById(\"myvideo\");\n    const data = {\n      id: mypeerID\n    };\n\n    if (v.muted) {\n      v.muted = false;\n      data.mute = false;\n    } else {\n      v.muted = true;\n      data.mute = true;\n    }\n\n    console.log(\"mute \" + mypeerID);\n    socket.emit(\"mute-unmute\", data);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"video-grid\",\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"video chat room\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      id: \"myvideo\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: muteunmute,\n      children: \"pause\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 171,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Videochatroom, \"YVBim1v63WObtXjvcGfKrSNrK8E=\");\n\n_c = Videochatroom;\nexport default _c2 = withRouter(Videochatroom);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Videochatroom\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["E:/video_project/client/src/Components/Videochatroom.js"],"names":["React","useState","useEffect","io","withRouter","Peer","Videochatroom","props","socket","setSocket","peers","addpeers","mypeerID","setmypeerID","myPeer","undefined","host","port","console","log","match","params","id","newsocket","connect","query","roomId","on","emit","myVideo","document","getElementById","muted","navigator","mediaDevices","getUserMedia","video","audio","then","stream","addVideoStream","userId","setTimeout","connectToNewUser","disconnectedVideo","remove","close","data","peervideo","mute","call","answer","createElement","peer","userVideoStream","removeAllListeners","element","myMediaTracks","getTracks","forEach","track","stop","error","prevstate","videoGrid","srcObject","addEventListener","play","append","muteunmute","v"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport Peer from \"peerjs\";\r\n\r\n//import { validate as uuidValidate } from \"uuid\";\r\n\r\nconst Videochatroom = (props) => {\r\n  // let socketInstance = useRef(null);\r\n\r\n  const [socket, setSocket] = useState(null);\r\n  const [peers, addpeers] = useState({});\r\n  // const [mystream, setstream] = useState(null);\r\n  const [mypeerID, setmypeerID] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const myPeer = new Peer(undefined, {\r\n      host: \"/\",\r\n      port: \"3008\",\r\n    });\r\n\r\n    //setmypeer(myPeer);\r\n\r\n    console.log(props.match.params.id);\r\n    console.log(\"mount it using useEffect!\");\r\n\r\n    const newsocket = io.connect(\"http://localhost:4000\", {\r\n      query: {\r\n        roomId: props.match.params.id,\r\n      },\r\n    });\r\n    console.log(\"socket id \" + newsocket.id);\r\n    setSocket(newsocket);\r\n    myPeer.on(\"open\", (id) => {\r\n      console.log(\"user id send to join room \" + id);\r\n\r\n      setmypeerID(id);\r\n      newsocket.emit(\"join-room\", id);\r\n    });\r\n\r\n    const myVideo = document.getElementById(\"myvideo\");\r\n    myVideo.muted = true;\r\n\r\n    console.log(\"alright now \");\r\n    navigator.mediaDevices\r\n      .getUserMedia({\r\n        video: true,\r\n        audio: true,\r\n      })\r\n      .then((stream) => {\r\n        // setstream(stream);\r\n        addVideoStream(myVideo, stream);\r\n\r\n        newsocket.on(\"user-connected\", (userId) => {\r\n          console.log(\"user id received of new user\" + userId);\r\n          setTimeout(connectToNewUser, 1000, userId, stream, myPeer);\r\n          // connectToNewUser(userId, stream, myPeer);\r\n        });\r\n        newsocket.on(\"user-disconnected\", (userId) => {\r\n          console.log(\"userid disconnected \" + userId);\r\n          const disconnectedVideo = document.getElementById(userId);\r\n          if (userId) {\r\n            disconnectedVideo.remove();\r\n          }\r\n\r\n          if (peers[userId]) peers[userId].close();\r\n        });\r\n        newsocket.on(\"mute-unmute\", (data) => {\r\n          if (data.id != myPeer.id) {\r\n            const peervideo = document.getElementById(data.id);\r\n            if (data.mute) peervideo.muted = true;\r\n            else peervideo.muted = false;\r\n          }\r\n        });\r\n\r\n        myPeer.on(\"call\", (call) => {\r\n          console.log(\"someone calling\");\r\n\r\n          call.answer(stream);\r\n          const video = document.createElement(\"video\");\r\n          console.log(\"call.peer \" + call.peer);\r\n          video.id = call.peer;\r\n          video.muted = true;\r\n\r\n          call.on(\"stream\", (userVideoStream) => {\r\n            addVideoStream(video, userVideoStream);\r\n          });\r\n\r\n          call.on(\"close\", () => {\r\n            console.log(\"call closing\");\r\n            myVideo.remove();\r\n          });\r\n        });\r\n      });\r\n\r\n    // return works like component will unmount\r\n    return () => {\r\n      newsocket.emit(\"user-disconnected\", myPeer.id);\r\n      newsocket.removeAllListeners();\r\n      const element = document.getElementById(myPeer.id);\r\n      const myMediaTracks = element?.stream.getTracks();\r\n      myMediaTracks?.forEach((track: any) => {\r\n        track.stop();\r\n      });\r\n    };\r\n  }, []);\r\n\r\n  const connectToNewUser = async (userId, stream, myPeer) => {\r\n    console.log(\"connecting to newuser! \");\r\n    const call = await myPeer.call(userId, stream);\r\n\r\n    call.on(\"error\", (error) => {\r\n      console.log(error);\r\n    });\r\n    // adding peers flush updates\r\n    console.log(\"peers adding \");\r\n    addpeers((prevstate) => ({\r\n      ...prevstate,\r\n      [userId]: call,\r\n    }));\r\n\r\n    const video = document.createElement(\"video\");\r\n    video.id = userId;\r\n    video.muted = true;\r\n    console.log(\"cALL \" + call + \"peer \" + myPeer.id);\r\n    if (call === null || call === \"\" || call === undefined) console.log(\"null\");\r\n\r\n    await call.on(\"stream\", (userVideoStream) => {\r\n      console.log(\"streaming \");\r\n      addVideoStream(video, userVideoStream);\r\n    });\r\n\r\n    call.on(\"close\", () => {\r\n      console.log(\"call closing \");\r\n      video.remove();\r\n    });\r\n    console.log(\"close\");\r\n  };\r\n\r\n  const addVideoStream = (video, stream) => {\r\n    console.log(\"adding video stream with id \", video.id);\r\n\r\n    const videoGrid = document.getElementById(\"video-grid\");\r\n    video.srcObject = stream;\r\n    video.addEventListener(\"loadedmetadata\", () => {\r\n      video.play();\r\n    });\r\n    videoGrid.append(video);\r\n\r\n    console.log(\":appending\");\r\n  };\r\n\r\n  const muteunmute = () => {\r\n    const v = document.getElementById(\"myvideo\");\r\n    const data = {\r\n      id: mypeerID,\r\n    };\r\n    if (v.muted) {\r\n      v.muted = false;\r\n      data.mute = false;\r\n    } else {\r\n      v.muted = true;\r\n      data.mute = true;\r\n    }\r\n    console.log(\"mute \" + mypeerID);\r\n\r\n    socket.emit(\"mute-unmute\", data);\r\n  };\r\n\r\n  return (\r\n    <div id=\"video-grid\">\r\n      <p>video chat room</p>\r\n      <video id=\"myvideo\" />\r\n      <button onClick={muteunmute}>pause</button>\r\n    </div>\r\n  );\r\n};\r\nexport default withRouter(Videochatroom);\r\n"]},"metadata":{},"sourceType":"module"}